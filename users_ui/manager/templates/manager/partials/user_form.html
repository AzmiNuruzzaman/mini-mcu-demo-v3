<!-- manager/templates/manager/partials/user_form.html -->

<h4 class="font-semibold mb-2">Add New User</h4>
<form method="POST" action="{% url 'manager:add_new_user' %}" class="mb-6">
    {% csrf_token %}
    <div class="mb-2">
        <label class="block mb-1 font-medium" for="username">Username:</label>
        <input type="text" id="username" name="username" class="border px-2 py-1 rounded w-1/3" required>
    </div>
    <div class="mb-2">
        <label class="block mb-1 font-medium" for="password">Password:</label>
        <input type="password" id="password" name="password" class="border px-2 py-1 rounded w-1/3" required>
    </div>
    <div class="mb-2">
        <label class="block mb-1 font-medium" for="role">Role:</label>
        <select id="role" name="role" class="border px-2 py-1 rounded w-1/3" required>
            <option value="">-- Select Role --</option>
            <option value="Manager">Manager</option>
            <option value="Tenaga Kesehatan">Nurse</option>
        </select>
    </div>
    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded mt-2">
        Add User
    </button>
</form>

<hr class="my-4">

<h4 class="font-semibold mb-2">Existing Users</h4>
<table class="table-auto w-full border">
    <thead>
        <tr>
            <th class="border px-2 py-1">ID</th>
            <th class="border px-2 py-1">Username</th>
            <th class="border px-2 py-1">Role</th>
            <th class="border px-2 py-1">Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for user in users %}
        <tr>
            <td class="border px-2 py-1">{{ user.id }}</td>
            <td class="border px-2 py-1">{{ user.username }}</td>
            <td class="border px-2 py-1">{{ user.role }}</td>
            <td class="border px-2 py-1 space-x-2">
                {% if user.id %}
                    <form method="POST" action="{% url 'manager:remove_user' user.id %}" class="inline">
                        {% csrf_token %}
                        <button type="submit" class="bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600">
                            Delete
                        </button>
                    </form>
                    <form method="POST" action="{% url 'manager:change_username' user.id %}" class="inline">
                        {% csrf_token %}
                        <input type="text" name="new_username" placeholder="New username" class="border px-2 py-1 rounded" required>
                        <button type="submit" class="bg-indigo-500 text-white px-2 py-1 rounded hover:bg-indigo-600">
                            Change Username
                        </button>
                    </form>
                    <form method="POST" action="{% url 'manager:reset_user_password' user.id %}" class="inline">
                        {% csrf_token %}
                        <input type="password" name="new_password" placeholder="New password" class="border px-2 py-1 rounded" required>
                        <button type="submit" class="bg-yellow-500 text-white px-2 py-1 rounded hover:bg-yellow-600">
                            Reset Password
                        </button>
                    </form>
                {% else %}
                    N/A
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" class="border px-2 py-1 text-center text-gray-500">No users found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
